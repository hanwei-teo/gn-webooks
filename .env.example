# =============================================================================
# Bugsnag Webhook Pipeline - Environment Configuration Template
# =============================================================================
# Copy this file to .env and update with your actual credentials
# cp .env.example .env
# =============================================================================

# Redis Configuration
# =============================================================================
# Redis host for message queuing between receiver and producer
REDIS_HOST=redis

# Kafka Configuration
# =============================================================================
# StreamNative/Pulsar Kafka-compatible endpoint
KAFKA_BOOTSTRAP_SERVERS=your_kafka_bootstrap_server:9093

# SASL authentication credentials
KAFKA_SASL_USERNAME=your_kafka_username
KAFKA_SASL_PASSWORD=your_jwt_token_here
KAFKA_SASL_MECHANISM=PLAIN

# Kafka topic for Bugsnag events
KAFKA_TOPIC=your_kafka_topic

# Schema Registry Configuration
# =============================================================================
# Schema Registry URL for AVRO schema management
SCHEMA_REGISTRY_URL=https://your_schema_registry_url/kafka

# Webhook Configuration
# =============================================================================
# Prefix for Redis queue names (e.g., webhook_bugsnag_queue)
WEBHOOK_QUEUE_PREFIX=webhook

# Type of webhook being processed (used for queue routing)
WEBHOOK_TYPE=bugsnag

# Kafka Producer Performance Configuration
# =============================================================================
# Conservative defaults (suitable for most environments)
KAFKA_BATCH_SIZE=16384              # 16KB batch size (was 131072)
KAFKA_LINGER_MS=100                    # 100ms linger time (was 5)
KAFKA_COMPRESSION_TYPE=none           # Compression algorithm (none, lz4, gzip, snappy)
KAFKA_BATCH_NUM_MESSAGES=10         # Messages per batch (was 100)

# Reliability settings
KAFKA_ACKS=all                         # Acknowledgment level (0, 1, all) (was 1)
KAFKA_RETRIES=3                      # Retry attempts for failed messages
KAFKA_MAX_IN_FLIGHT=5               # Max in-flight requests per connection (was 10)

# Buffer and queue settings
KAFKA_QUEUE_MAX_MESSAGES=1000       # Max queued messages in producer (was 10000)
KAFKA_QUEUE_MAX_KBYTES=8192         # Max queue size in KB (was 32768)
KAFKA_SOCKET_SEND_BUFFER=65536      # Socket send buffer size (was 262144)
KAFKA_SOCKET_RECEIVE_BUFFER=65536   # Socket receive buffer size (was 131072)

# Idempotence (set to 'true' for exactly-once delivery)
KAFKA_ENABLE_IDEMPOTENCE=false       # Enable exactly-once delivery

# =============================================================================
# Configuration Notes:
# =============================================================================
# 1. Replace all 'your_*' values with your actual credentials
# 2. KAFKA_SASL_PASSWORD should be a valid JWT token for StreamNative
# 3. KAFKA_TOPIC should follow your organization's naming convention
# 4. Performance settings use conservative defaults suitable for most environments
# 5. WEBHOOK_TYPE can be changed to support other webhook types in the future
# =============================================================================
